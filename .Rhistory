library(zoo)
# import data
path = './Output/impute.csv'
data = read.csv(path, header=TRUE, sep=",")
data = subset(data, select=-X)
days = nrow(data)
measurements = ncol(data)
names(data) = 1:measurements
#visualization (while engineering)
# a) local polynomial regression
x = 1:measurements
#START = 200
START = 42
par(mfrow=c(3, 3))
for (i in START:(START+8)) {
y = unlist(data[i, ])
#local.poly = loess(y ~ x, span=0.1)
local.poly = loess(y ~ x, deg=1, span=0.05)
x.test = x[is.na(y)]
y.pred = predict(local.poly, newdata=x.test)
yy = y
yy[is.na(y)] = y.pred
plot(x, yy, col="green", type="l", lwd=2)
lines(x, y, lwd=2)
(imputed_values = sum(!is.na(y.pred)))
}
# b) interpolation
par(mfrow=c(3, 3))
